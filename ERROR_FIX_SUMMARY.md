# Исправление ошибок "Failed to fetch"

## Проблема
Фронтенд пытался подключиться напрямую к бэкенду на `http://localhost:9999`, что вызывало ошибки "Failed to fetch" в консоли, когда бэкенд не был запущен.

## Решение

### 1. Использование Next.js API роутов
- Изменен `API_BASE` с `'http://localhost:9999'` на `''` (относительный путь)
- Теперь все запросы идут через Next.js API роуты, которые проксируют к бэкенду

### 2. Улучшенная обработка ошибок

#### В компоненте (`app/normalization/page.tsx`):
- Убраны `console.error` для случаев, когда бэкенд недоступен
- Добавлены комментарии, объясняющие, что отсутствие бэкенда - это нормально
- Улучшена обработка ошибок SSE соединения

#### В API роутах:
- Добавлена обработка случаев, когда бэкенд недоступен
- API роуты возвращают дефолтные значения вместо ошибок:
  - `/api/normalization/status` возвращает статус с `currentStep: 'Бэкенд недоступен'`
  - `/api/normalization/stats` возвращает нулевую статистику

### 3. SSE соединение
- SSE остается с прямым подключением к бэкенду (через `NEXT_PUBLIC_BACKEND_URL`)
- Это необходимо, так как SSE не работает через Next.js API роуты
- Улучшена обработка ошибок SSE с проверкой состояния соединения

## Результат

✅ Ошибки "Failed to fetch" больше не засоряют консоль
✅ Интерфейс корректно работает даже когда бэкенд не запущен
✅ Пользователь видит понятное сообщение "Бэкенд недоступен" вместо ошибок
✅ При запуске бэкенда все функции работают автоматически

## Переменные окружения

Для настройки URL бэкенда создайте файл `frontend/.env.local`:

```
NEXT_PUBLIC_BACKEND_URL=http://localhost:9999
BACKEND_URL=http://localhost:9999
```

- `NEXT_PUBLIC_BACKEND_URL` - используется для SSE соединений (клиентская сторона)
- `BACKEND_URL` - используется для серверных API роутов (серверная сторона)

