# Отображение Word-Based Дубликатов на Фронтенде

## Визуальное представление

Word-based дубликаты отображаются на странице `/quality/duplicates` с следующими характеристиками:

### 1. Бейдж типа дубликата
- **Цвет**: Зеленый (`bg-green-500 text-white`)
- **Иконка**: 🟢
- **Текст**: "Группировка по словам"
- **Расположение**: В верхней части карточки группы дубликатов

### 2. Информация о группе
- **Процент схожести**: Отображается в цветном бейдже (зависит от значения)
- **Количество записей**: Бейдж с количеством элементов в группе
- **Причина группировки**: Отображается в виде бейджа с текстом из поля `reason`
  - Пример: "Common words (2): ноутбук, gaming"

### 3. Структура отображения

```
┌─────────────────────────────────────────────────┐
│ 🟢 Группировка по словам  [75% схожесть] [3 записи] │
│ Common words (2): ноутбук, gaming              │
│                                                 │
│ Группа дубликатов #123                         │
│ Создано: 15.01.2025, 14:30:00                 │
│                    [Объединить]                │
├─────────────────────────────────────────────────┤
│ ⭐ Рекомендуемая мастер-запись                 │
│ ID: #45 | Код: NB-001                          │
│ Название: ноутбук asus gaming мощный           │
│ Категория: Electronics                          │
├─────────────────────────────────────────────────┤
│ Все записи в группе:                           │
│                                                 │
│ #45 ⭐ ноутбук asus gaming мощный              │
│     Код: NB-001 | КПВЭД: 26.20.11             │
│                                                 │
│ #67   ноутбук lenovo gaming                    │
│     Код: NB-002 | КПВЭД: 26.20.11             │
│                                                 │
│ #89   ноутбук dell gaming                      │
│     Код: NB-003 | КПВЭД: 26.20.11             │
└─────────────────────────────────────────────────┘
```

## API Response Format

API возвращает данные в следующем формате:

```json
{
  "groups": [
    {
      "id": 123,
      "duplicate_type": "word_based",
      "similarity_score": 0.75,
      "item_count": 3,
      "item_ids": [45, 67, 89],
      "suggested_master_id": 45,
      "reason": "Common words (2): ноутбук, gaming",
      "merged": false,
      "created_at": "2025-01-15T14:30:00Z",
      "items": [
        {
          "id": 45,
          "code": "NB-001",
          "normalized_name": "ноутбук asus gaming мощный",
          "category": "Electronics",
          "kpved_code": "26.20.11",
          "quality_score": 0.9,
          "processing_level": "ai_enhanced",
          "merged_count": 0
        },
        // ... другие элементы
      ]
    }
  ],
  "total": 1,
  "limit": 50,
  "offset": 0
}
```

## Конфигурация типов дубликатов

Все поддерживаемые типы в `methodConfig`:

| Тип | Метка | Цвет | Иконка |
|-----|-------|------|--------|
| `exact` | Точное совпадение | Красный | 🔴 |
| `exact_code` | Точное совпадение кода | Красный | 🔴 |
| `exact_name` | Точное совпадение имени | Оранжевый | 🟠 |
| `semantic` | Семантическое сходство | Синий | 🔵 |
| `phonetic` | Фонетическое сходство | Фиолетовый | 🟣 |
| `word_based` | Группировка по словам | Зеленый | 🟢 |
| `mixed` | Смешанный тип | Серый | ⚫ |

## Особенности отображения

1. **Причина группировки**: Поле `reason` содержит информацию об общих словах, что помогает понять, почему элементы были сгруппированы вместе.

2. **Мастер-запись**: Выделяется желтым фоном и иконкой звезды. Выбирается автоматически на основе:
   - Высокого качества данных
   - AI-enhanced обработки
   - Количества уже объединенных записей

3. **Схожесть**: Процент схожести вычисляется на основе количества общих слов относительно общего количества уникальных слов в названиях.

4. **Фильтрация**: Можно фильтровать по:
   - Только необъединенные группы
   - Все группы (включая объединенные)

## Примеры reason для word_based дубликатов

- `"Common words (1): ноутбук"` - одно общее слово
- `"Common words (2): ноутбук, gaming"` - два общих слова
- `"Common words (3): компьютер, мышь, беспроводная"` - три общих слова
- `"Word-based similarity detected"` - если не удалось определить точные общие слова

## Интеграция с существующими типами

Word-based дубликаты автоматически:
- Объединяются с другими типами дубликатов через `mergeOverlappingGroups()`
- Могут быть помечены как `mixed` если пересекаются с другими типами
- Сохраняются в БД с типом `word_based` в поле `duplicate_type`

