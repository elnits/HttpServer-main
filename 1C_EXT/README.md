# Эталонный набор файлов для обработки 1С

## Описание

Этот набор содержит финальные версии всех файлов, необходимых для работы обработки выгрузки данных из 1С в сервис нормализации и анализа.

**Дата создания эталона:** 2025-11-16

## Структура файлов

```
1C_EXT/
├── README.md                    - Этот файл
├── Module.bsl                   - Основной модуль обработки
├── ModuleExtensions.bsl         - Расширения модуля (все функции выгрузки)
├── FormInstructions.md          - Инструкция по настройке формы
├── IntegrationGuide.md          - Руководство по интеграции
└── CHANGELOG.md                 - История изменений
```

## Быстрый старт

### 1. Установка модуля

1. Откройте обработку в конфигураторе 1С
2. Откройте модуль обработки
3. Скопируйте содержимое `Module.bsl` в основной модуль
4. Скопируйте содержимое `ModuleExtensions.bsl` в конец модуля (или создайте отдельный модуль расширений)

### 2. Настройка формы

1. Следуйте инструкциям из `FormInstructions.md`
2. Добавьте все необходимые реквизиты формы
3. Создайте элементы формы (группы, поля, кнопки)
4. Привяжите команды к процедурам

### 3. Проверка

1. Запустите обработку в режиме предприятия
2. Проверьте соединение с сервером (кнопка "Проверить соединение")
3. Выполните тестовую выгрузку

## Основные возможности

### ✅ Идентификация базы данных

- **Приоритет 1:** Прямой `database_id` (если указан)
- **Приоритет 2:** Поиск по `client_id` и `project_id`
- **Приоритет 3:** Автоматическое создание новой базы данных

### ✅ Выгрузка данных

- Выгрузка констант
- Выгрузка справочников (с пакетной отправкой)
- Выгрузка номенклатуры с характеристиками
- Выгрузка в JSON файл

### ✅ Отслеживание итераций

- Номер итерации (`iteration_number`)
- Метка итерации (`iteration_label`)
- Имя программиста (`programmer_name`)
- Цель выгрузки (`upload_purpose`)
- Связь с родительской выгрузкой (`parent_upload_id`)

### ✅ Прогресс выгрузки

- Индикатор прогресса (0-100%)
- Отображение текущего этапа
- Отображение текущего объекта
- Возможность прерывания выгрузки

## Требования

- **1С:Предприятие 8.3** или выше
- **HTTP сервер** должен быть доступен по указанному адресу
- **База данных** должна быть создана на сервере (или будет создана автоматически)

## Настройки по умолчанию

- **Адрес сервера:** `http://localhost:9999`
- **Пакетная выгрузка:** Включена
- **Размер пакета:** 50 элементов
- **Идентификатор базы данных:** Пусто (будет определен автоматически)

## API сервера

Обработка взаимодействует со следующими эндпоинтами:

- `POST /handshake` - Рукопожатие, получение UUID выгрузки
- `POST /metadata` - Отправка метаинформации
- `POST /constant` - Отправка константы
- `POST /catalog/meta` - Отправка метаданных справочника
- `POST /catalog/item` - Отправка элемента справочника
- `POST /catalog/items` - Пакетная отправка элементов справочника
- `POST /complete` - Завершение выгрузки

## Поддержка

При возникновении проблем:

1. Проверьте логи сервера
2. Проверьте сообщения в окне сообщений 1С
3. Убедитесь, что все процедуры правильно интегрированы
4. Проверьте настройки формы обработки
5. Проверьте доступность сервера

## Версия

**Версия эталона:** 1.0.0  
**Дата:** 2025-11-16  
**Статус:** Готов к использованию

