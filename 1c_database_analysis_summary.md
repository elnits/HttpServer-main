# Анализ базы данных 1c_data.db на наличие системной информации

## Дата анализа
2025-01-XX

## Общая информация

База данных `1c_data.db` содержит данные, полученные из информационных баз 1С через HTTP сервер.

## Найденная системная информация

### 1. Информация о выгрузках (таблица uploads)

**Всего выгрузок:** 44

#### Версии платформы 1С:Предприятие
- **8.3.25.1286** - используется в конфигурации ERPWE
- **8.3.26.1521** - используется в конфигурации УправлениеНСИ
- **8.3.27.1508** - используется в конфигурации "Конфигурация"

#### Имена конфигураций
1. **ERPWE** - найдена в 1 выгрузке (ID: 44)
2. **УправлениеНСИ** - найдена в 38 выгрузках (ID: 5-42, частично)
3. **Конфигурация** - найдена в 5 выгрузках (ID: 2-4, 15, 30-31)

#### Статистика по выгрузкам
- **Самая большая выгрузка:** ID 44 (ERPWE) - 15973 элементов справочников
- **Выгрузки с константами:** ID 5, 39-42 (УправлениеНСИ) - по 360 констант
- **Выгрузки с полным набором справочников:** ID 5, 19 (УправлениеНСИ) - по 248 справочников

### 2. Константы

**Всего констант в базе:** 360 (в выгрузках УправлениеНСИ)

Системные константы по ключевым словам (версия, конфигурация, база, путь, сервер) **не найдены**.

Константы присутствуют только в выгрузках из конфигурации "УправлениеНСИ".

### 3. Справочники

**Всего справочников:** 250 уникальных

Справочники включают:
- Системные справочники 1С (Пользователи, Организации, Валюты и т.д.)
- Справочники конфигурации УправлениеНСИ (нси*)
- Справочники конфигурации ERPWE
- Справочники корпоративной шины данных (кшд*)
- Справочники машинного обучения (мии*)

### 4. Элементы справочников

**Всего элементов:** более 16,000 (только в последней выгрузке ERPWE - 15973)

Системная информация в XML атрибутах элементов справочников **не обнаружена**.

## Выводы

### Наличие системной информации

✅ **Найдено:**
1. **Версии платформы 1С** - хранятся в таблице `uploads` (поле `version_1c`)
2. **Имена конфигураций** - хранятся в таблице `uploads` (поле `config_name`)
3. **Временные метки выгрузок** - позволяют определить источник и время получения данных
4. **UUID выгрузок** - уникальные идентификаторы каждой выгрузки

❌ **Не найдено:**
1. Пути к информационным базам 1С
2. Адреса серверов 1С
3. Системные константы с информацией о расположении баз
4. Системная информация в XML атрибутах элементов справочников

### Источники данных

База данных содержит данные из **3 различных конфигураций 1С:**
1. **ERPWE** (1 выгрузка) - платформа 8.3.25.1286
2. **УправлениеНСИ** (большинство выгрузок) - платформа 8.3.26.1521
3. **Конфигурация** (несколько выгрузок) - платформа 8.3.27.1508

### Рекомендации

1. Для получения информации о расположении баз данных 1С необходимо:
   - Проверить константы в самой информационной базе 1С
   - Использовать API 1С для получения системной информации
   - Проверить настройки HTTP сервера, который принимает данные

2. Для идентификации источника данных можно использовать:
   - Комбинацию `version_1c` + `config_name` из таблицы `uploads`
   - UUID выгрузки для отслеживания конкретной выгрузки
   - Временные метки для определения последовательности выгрузок

3. Для получения дополнительной системной информации рекомендуется:
   - Расширить обработку XML данных из 1С для извлечения системных параметров
   - Добавить в HTTP сервер логирование IP-адресов источников
   - Сохранять метаданные о соединении в отдельной таблице

## Структура базы данных

### Таблица uploads
- `id` - уникальный идентификатор выгрузки
- `upload_uuid` - UUID выгрузки
- `started_at` - время начала выгрузки
- `completed_at` - время завершения выгрузки
- `status` - статус выгрузки (in_progress, completed)
- **`version_1c`** - версия платформы 1С ⚙️
- **`config_name`** - имя конфигурации ⚙️
- `total_constants` - количество констант
- `total_catalogs` - количество справочников
- `total_items` - количество элементов справочников

### Таблица constants
- `id` - уникальный идентификатор
- `upload_id` - ссылка на выгрузку
- `name` - имя константы
- `synonym` - синоним
- `type` - тип
- `value` - значение

### Таблица catalogs
- `id` - уникальный идентификатор
- `upload_id` - ссылка на выгрузку
- `name` - имя справочника
- `synonym` - синоним

### Таблица catalog_items
- `id` - уникальный идентификатор
- `catalog_id` - ссылка на справочник
- `reference` - ссылка на элемент
- `code` - код элемента
- `name` - наименование элемента
- `attributes_xml` - XML с реквизитами
- `table_parts_xml` - XML с табличными частями

## Инструмент анализа

Для повторного анализа базы данных используйте:
```bash
.\analyze_1c_db.exe 1c_data.db
```

Скрипт находится в: `cmd/analyze_1c_db/main.go`

