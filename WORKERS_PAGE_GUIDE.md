# Руководство по использованию страницы управления воркерами и моделями

## Обзор

Страница `/workers` предоставляет полнофункциональный интерфейс для управления AI провайдерами, моделями, API ключами и настройками воркеров.

## Доступ к странице

- **URL**: `http://localhost:3000/workers` (или ваш домен)
- **Навигация**: Меню → "Воркеры"

## Основные функции

### 1. Управление API ключами (токенами)

#### Ввод и сохранение API ключа
- Каждый провайдер имеет отдельное поле для ввода API ключа
- Ключ сохраняется автоматически при вводе
- Если поле пустое, система использует ключ из переменных окружений (`ARLIAI_API_KEY` и т.д.)

#### Проверка подключения
- Кнопка **"Проверить"** доступна для провайдера Arliai
- При нажатии выполняется проверка валидности API ключа и доступности сервиса
- Статус проверки отображается визуально:
  - ✅ **Зеленый индикатор** - подключение установлено
  - ❌ **Красный индикатор** - ошибка с описанием проблемы
  - ⏳ **Спиннер** - проверка в процессе

#### Автоматическая проверка
- Статус подключения проверяется автоматически при загрузке страницы
- После сохранения API ключа выполняется автоматическая проверка (с небольшой задержкой)

### 2. Управление провайдерами

#### Включение/выключение провайдера
- Переключатель для каждого провайдера
- Выключенные провайдеры не используются системой

#### Настройка приоритета
- Приоритет: меньшее число = выше приоритет (1 < 2 < 3)
- Система автоматически выбирает провайдер с наименьшим приоритетом среди включенных

#### Количество воркеров
- Максимальное количество параллельных запросов для каждого провайдера
- Диапазон: от 1 до 100

#### Установка провайдера по умолчанию
- Кнопка "Установить по умолчанию" для выключенных провайдеров
- Используется, если нет активных провайдеров

### 3. Управление моделями

#### Включение/выключение модели
- Переключатель для каждой модели
- Выключенные модели не используются

#### Настройка приоритета
- Приоритет модели в рамках провайдера
- Система выбирает модель с наименьшим приоритетом среди включенных

#### Установка модели по умолчанию
- Кнопка "По умолчанию" для включенных моделей
- Используется, если нет активных моделей

#### Просмотр характеристик
- **Max Tokens** - максимальное количество токенов
- **Temperature** - температура генерации
- **Speed** - скорость работы (fast, medium, slow)
- **Quality** - качество результатов (high, medium, low)

### 4. Глобальные настройки

#### Глобальный максимум воркеров
- Ограничивает общее количество воркеров для всех провайдеров
- Фактическое количество = минимум(глобальный лимит, лимит провайдера)

#### Настройки по умолчанию
- Выбор провайдера по умолчанию из выпадающего списка
- Выбор модели по умолчанию из списка включенных моделей

## Вкладки интерфейса

### 1. Провайдеры и модели
Основное управление провайдерами, их моделями и API ключами.

### 2. Воркеры
Настройка глобального количества воркеров и просмотр текущих настроек по провайдерам.

### 3. Настройки по умолчанию
Выбор провайдера и модели, которые будут использоваться по умолчанию.

## Обработка ошибок

### Детальные сообщения об ошибках
- Проверка наличия API ключа
- Информативные подсказки для пользователя
- Описание проблем с подключением

### Типичные ошибки и решения

#### "API ключ не установлен"
- Введите API ключ в поле для провайдера
- Или установите переменную окружения `ARLIAI_API_KEY`

#### "Подключение не установлено"
- Проверьте правильность API ключа
- Убедитесь, что сервис доступен
- Проверьте интернет-соединение

#### "Провайдер не найден"
- Обновите страницу
- Проверьте, что сервер запущен

## Технические детали

### API эндпоинты
- `GET /api/workers/config` - получение конфигурации
- `POST /api/workers/config/update` - обновление конфигурации
- `GET /api/workers/arliai/status` - проверка статуса подключения Arliai

### Безопасность
- API ключи скрыты в ответах GET запросов
- Ключи передаются только при обновлении конфигурации
- Используется HTTPS для передачи данных (в продакшене)

### Применение изменений
- Все изменения применяются **без перезапуска сервера**
- Конфигурация обновляется мгновенно
- Автоматическая проверка статуса после изменений

## Примеры использования

### Настройка нового API ключа
1. Откройте страницу `/workers`
2. Раскройте провайдер "arliai"
3. Введите API ключ в поле "API Ключ"
4. Нажмите "Проверить" для проверки подключения
5. Дождитесь подтверждения (зеленый индикатор)

### Изменение приоритета модели
1. Раскройте провайдер
2. Найдите нужную модель
3. Измените значение приоритета (меньше = выше приоритет)
4. Изменение сохранится автоматически

### Увеличение количества воркеров
1. Перейдите на вкладку "Воркеры"
2. Измените значение "Глобальный максимум воркеров"
3. Или измените "Макс. воркеров" для конкретного провайдера
4. Изменение применится немедленно

## Рекомендации

1. **Приоритеты**: Используйте приоритет 1 для основного провайдера/модели
2. **Воркеры**: Не устанавливайте слишком большое количество воркеров (рекомендуется 2-4)
3. **API ключи**: Регулярно проверяйте статус подключения
4. **Резервные модели**: Настройте несколько моделей с разными приоритетами для отказоустойчивости

## Поддержка

При возникновении проблем:
1. Проверьте статус подключения к API
2. Убедитесь, что сервер запущен
3. Проверьте логи сервера
4. Обновите страницу и попробуйте снова

