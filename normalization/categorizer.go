package normalization

import (
	"strings"
)

// Categorizer определяет категорию товара на основе ключевых слов
type Categorizer struct {
	categories map[string][]string
}

// NewCategorizer создает новый категоризатор с предустановленными категориями
func NewCategorizer() *Categorizer {
	return &Categorizer{
		categories: map[string][]string{
			"инструмент": {
				"лопата", "монтировка", "молоток", "отвертка", "ключ", "ножницы",
				"пила", "дрель", "шуруповерт", "шуп", "пробоотборник",
			},
			"медикаменты": {
				"энрофлоксацин", "колистин", "антибиотик", "витамин", "лекарство",
				"медикамент", "препарат", "медицинский",
			},
			"стройматериалы": {
				"труба", "панель", "коробка", "кабель", "провод", "кран", "смеситель",
				"раковина", "унитаз", "шуруп", "винт", "болт", "гвоздь",
			},
			"электроника": {
				"телефон", "роутер", "маршрутизатор", "точка доступа", "кабель",
				"адаптер", "модем", "компьютер", "ноутбук", "сотовый",
			},
			"оборудование": {
				"конвейер", "мельница", "котел", "вентилятор", "дождеватель",
				"насос", "компрессор", "генератор", "бункер", "уловитель",
			},
			"расходники": {
				"салфетка", "добавка", "топливопровод", "полиэтилен", "пленка",
				"скотч", "клей", "лента", "бумага", "наждачная",
			},
			"автоаксессуары": {
				"коврик", "чехол", "зеркало", "фара", "задней четвертины",
				"филе", "бедрышки", "маринованные",
			},
			"канцелярия": {
				"маркер", "ручка", "карандаш", "ластик", "степлер", "скрепка",
				"бумага", "наждачная бумага", "спрей для чистки маркерной",
			},
			"средства очистки": {
				"спрей", "дезинфицирующая", "моющее", "чистка", "дезинфекция",
			},
			"продукты": {
				"маринованные", "соленые", "копченые", "колбаса", "сыр",
				"молоко", "хлеб", "филе", "бедрышки",
			},
			"сельское хозяйство": {
				"кормовая", "добавка кормовая", "удобрение", "пестицид",
				"инсектицид", "корм",
			},
			"связь": {
				"телефон", "сотовый", "nokia", "роутер", "маршрутизатор",
			},
			"сантехника": {
				"смеситель", "раковина", "унитаз", "ванна", "душ", "труба",
				"шланг", "кран",
			},
			"мебель": {
				"стол", "стул", "кровать", "шкаф", "полка", "тумба",
			},
			"инструменты измерительные": {
				"мегаомметр", "мультиметр", "вольтметр", "амперметр",
				"тахометр", "стандарт мутности",
			},
			"программное обеспечение": {
				"резервное копирование", "программа", "приложение", "софт",
			},
			"упаковка": {
				"полиэтилен", "пакет", "коробка", "контейнер", "бутылка",
				"банка", "упаковка",
			},
		},
	}
}

// Categorize определяет категорию товара на основе его названия
func (c *Categorizer) Categorize(name string) string {
	nameLower := strings.ToLower(name)

	// Проверяем каждую категорию
	for category, keywords := range c.categories {
		for _, keyword := range keywords {
			if strings.Contains(nameLower, keyword) {
				return category
			}
		}
	}

	// Если категория не найдена, возвращаем "другое"
	return "другое"
}

